<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMS - Contact Center Attendance</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <div id="loginPage" class="page active">
        <div class="login-container">
            <h2>AMS Login</h2>
            <form id="loginForm">
                <div class="input-group">
                    <label for="loginEmail">Email:</label>
                    <input type="email" id="loginEmail" placeholder="your.email@example.com" required>
                </div>
                <div class="input-group">
                    <label for="loginPassword">Password:</label>
                    <input type="password" id="loginPassword" placeholder="********" required>
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
                <p id="loginError" class="error-message"></p>
            </form>
        </div>
    </div>

    <div id="appContainer" class="app-container">
        <aside class="sidebar">
            <div class="logo">AMS</div>
            <nav class="main-nav">
                <ul>
                    <li><a href="#" data-page="home">Home</a></li>
                    <li><a href="#" data-page="attendance">Attendance Marking</a></li>
                    <li><a href="#" data-page="dashboard">Dashboard</a></li>
                    <li><a href="#" data-page="reports">Reports</a></li>
                    <li><a href="#" data-page="admin">Admin Panel</a></li> </ul>
            </nav>
            <button id="logoutBtn" class="btn btn-secondary logout-btn">Logout</button>
        </aside>

        <main class="main-content">
            <header class="app-header">
                <h1>Welcome to Attendance Management System</h1>
                <div class="user-info">
                    <span>Hello, <strong id="loggedInUserName">Agent Name</strong></span>
                    <span class="user-role" id="loggedInUserRole">Agent</span>
                </div>
            </header>

            <div id="homePage" class="content-module active">
                <h2>Today's Statistics</h2>
                <hr>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Clocked In</h3>
                        <p id="statClockedIn" class="stat-value">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Scheduled Shifts</h3>
                        <p id="statScheduledShifts" class="stat-value">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Agents on Break</h3>
                        <p id="statOnBreak" class="stat-value">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Pending Leave</h3>
                        <p id="statPendingLeave" class="stat-value">0</p>
                    </div>
                </div>

                <h3>Notifications</h3>
                <div class="notifications-list">
                    <div class="notification-item">
                        <span class="notification-icon success">&#10003;</span>
                        <p>Your leave request for July 15th has been **approved**.</p>
                    </div>
                    <div class="notification-item">
                        <span class="notification-icon info">&#9432;</span>
                        <p>Reminder: Your shift starts in 30 minutes (09:00 AM).</p>
                    </div>
                    <div class="notification-item">
                        <span class="notification-icon warning">&#9888;</span>
                        <p>Alert: Team Delta has 2 late logins today.</p>
                    </div>
                </div>
            </div>

            <div id="attendancePage" class="content-module">
                <h2>Attendance Marking & Overview</h2>
                <hr>
                <div class="attendance-filters">
                    <div class="input-group">
                        <label for="attendanceDateFilter">Select Date:</label>
                        <input type="date" id="attendanceDateFilter">
                    </div>
                    <div class="input-group">
                        <label for="teamFilter">Select Team:</label>
                        <select id="teamFilter">
                            <option value="all">All Teams</option>
                            <option value="alpha">Team Alpha</option>
                            <option value="beta">Team Beta</option>
                            </select>
                    </div>
                    <button class="btn btn-primary" id="loadAttendanceBtn">Load Attendance</button>
                </div>

                <div class="attendance-table-container">
                    <table class="attendance-table">
                        <thead>
                            <tr>
                                <th>Agent Name</th>
                                <th>Status (Today)</th>
                                <th>Clock In</th>
                                <th>Clock Out</th>
                                <th>Break Start</th>
                                <th>Break End</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <tr data-agent-id="agent123" data-agent-name="John Doe">
                                <td>John Doe</td>
                                <td>
                                    <select class="attendance-status-dropdown">
                                        <option value="present">Present</option>
                                        <option value="late">Late</option>
                                        <option value="absent">Absent</option>
                                        <option value="excused_absence">Excused Absence</option>
                                        <option value="on_leave">On Leave</option>
                                        <option value="holiday">Holiday</option>
                                    </select>
                                </td>
                                <td contenteditable="true" class="editable-time">09:00 AM</td>
                                <td contenteditable="true" class="editable-time">05:00 PM</td>
                                <td contenteditable="true" class="editable-time">01:00 PM</td>
                                <td contenteditable="true" class="editable-time">01:30 PM</td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr data-agent-id="agent456" data-agent-name="Jane Smith">
                                <td>Jane Smith</td>
                                <td>
                                    <select class="attendance-status-dropdown">
                                        <option value="present">Present</option>
                                        <option value="late">Late</option>
                                        <option value="absent">Absent</option>
                                        <option value="excused_absence">Excused Absence</option>
                                        <option value="on_leave" selected>On Leave</option>
                                        <option value="holiday">Holiday</option>
                                    </select>
                                </td>
                                <td contenteditable="true" class="editable-time">N/A</td>
                                <td contenteditable="true" class="editable-time">N/A</td>
                                <td contenteditable="true" class="editable-time">N/A</td>
                                <td contenteditable="true" class="editable-time">N/A</td>
                                <td contenteditable="true">Annual Leave</td>
                            </tr>
                            </tbody>
                    </table>
                </div>
                <button class="btn btn-primary save-attendance-btn">Save Changes</button>
            </div>

            <div id="dashboardPage" class="content-module">
                <h2>Dashboard</h2>
                <hr>
                <div class="dashboard-grid">
                    <div class="dashboard-card team-status">
                        <h3>Team Alpha Status (Real-time)</h3>
                        <ul class="agent-status-list">
                            <li>
                                <span class="status-indicator online"></span>
                                John Doe <span class="status-label">Clocked In</span>
                            </li>
                            <li>
                                <span class="status-indicator break"></span>
                                Jane Smith <span class="status-label">On Break</span>
                            </li>
                            <li>
                                <span class="status-indicator offline"></span>
                                Peter Jones <span class="status-label">Clocked Out</span>
                            </li>
                            <li>
                                <span class="status-indicator late"></span>
                                Mary Lee <span class="status-label">Late</span>
                            </li>
                            <li>
                                <span class="status-indicator absent"></span>
                                David Kim <span class="status-label">Absent</span>
                            </li>
                        </ul>
                    </div>
                    <div class="dashboard-card pending-actions">
                        <h3>Pending Actions</h3>
                        <ul>
                            <li>Leave Request: Sarah Brown (July 20-22) - <a href="#">Review</a></li>
                            <li>Shift Swap: Mike Green (from 9-5 to 11-7) - <a href="#">Approve</a></li>
                            <li>Late Login: Emily White (09:15 AM) - <a href="#">Acknowledge</a></li>
                        </ul>
                    </div>
                    <div class="dashboard-card shift-overview">
                        <h3>Shift Overview (Today)</h3>
                        <p>Morning Shift (09:00 - 17:00): 10/12 Agents</p>
                        <p>Afternoon Shift (13:00 - 21:00): 7/8 Agents</p>
                        <p>Night Shift (21:00 - 05:00): 4/5 Agents</p>
                        <button class="btn btn-sm btn-primary">Manage Schedules</button>
                    </div>
                </div>
            </div>

            <div id="reportsPage" class="content-module">
                <h2>Attendance Reports & Analytics</h2>
                <hr>
                <div class="report-filters">
                    <div class="input-group">
                        <label for="reportType">Report Type:</label>
                        <select id="reportType">
                            <option value="daily">Daily Summary</option>
                            <option value="weekly">Weekly Summary</option>
                            <option value="monthly">Monthly Summary</option>
                            <option value="tardiness">Tardiness Report</option>
                            <option value="absenteeism">Absenteeism Report</option>
                            <option value="overtime">Overtime Report</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="startDate">Start Date:</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="input-group">
                        <label for="endDate">End Date:</label>
                        <input type="date" id="endDate">
                    </div>
                    <button class="btn btn-primary">Generate Report</button>
                    <button class="btn btn-secondary">Export to CSV</button>
                </div>

                <div class="report-results">
                    <h3>Generated Report (Example)</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Agent</th>
                                <th>Clock In</th>
                                <th>Clock Out</th>
                                <th>Total Hours</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2025-07-07</td>
                                <td>John Doe</td>
                                <td>08:58 AM</td>
                                <td>05:02 PM</td>
                                <td>8.06</td>
                                <td class="status-good">On Time</td>
                            </tr>
                            <tr>
                                <td>2025-07-07</td>
                                <td>Jane Smith</td>
                                <td>09:10 AM</td>
                                <td>05:00 PM</td>
                                <td>7.83</td>
                                <td class="status-warning">Late</td>
                            </tr>
                            <tr>
                                <td>2025-07-07</td>
                                <td>Peter Jones</td>
                                <td>-</td>
                                <td>-</td>
                                <td>0.00</td>
                                <td class="status-danger">Absent</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="adminPage" class="content-module">
                <h2>Admin Panel - Manage Agents</h2>
                <hr>
                <h3>Add New Agent</h3>
                <form id="addAgentForm" class="add-agent-form">
                    <div class="input-group">
                        <label for="agentName">Agent Name:</label>
                        <input type="text" id="agentName" required placeholder="e.g., Alice Wonderland">
                    </div>
                    <div class="input-group">
                        <label for="agentEmail">Agent Email:</label>
                        <input type="email" id="agentEmail" required placeholder="e.g., alice@example.com">
                    </div>
                    <button type="submit" class="btn btn-success">Add Agent</button>
                </form>

                <h3>Existing Agents</h3>
                <div class="existing-agents-list">
                    <ul id="agentsList">
                        <li>John Doe <button class="btn btn-sm btn-danger remove-agent-btn">Remove</button></li>
                        <li>Jane Smith <button class="btn btn-sm btn-danger remove-agent-btn">Remove</button></li>
                    </ul>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Simple JavaScript for UI navigation and specific module logic (no Firebase yet)
        document.addEventListener('DOMContentLoaded', () => {
            const loginPage = document.getElementById('loginPage');
            const appContainer = document.getElementById('appContainer');
            const navLinks = document.querySelectorAll('.main-nav a');
            const logoutBtn = document.getElementById('logoutBtn');
            const loginForm = document.getElementById('loginForm');
            const attendanceDateFilter = document.getElementById('attendanceDateFilter');
            const attendanceTableBody = document.getElementById('attendanceTableBody');
            const loadAttendanceBtn = document.getElementById('loadAttendanceBtn');
            const saveAttendanceBtn = document.querySelector('.save-attendance-btn');
            const addAgentForm = document.getElementById('addAgentForm');
            const agentsList = document.getElementById('agentsList');

            // Set today's date as default for attendance filter
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            attendanceDateFilter.value = `${year}-${month}-${day}`;

            // --- UI Simulation (replace with actual Firebase logic) ---
            let isLoggedIn = false; // Simulate login state

            function showPage(pageId) {
                document.querySelectorAll('.content-module').forEach(page => {
                    page.classList.remove('active');
                });
                document.getElementById(pageId).classList.add('active');

                // Update active state in nav
                navLinks.forEach(link => {
                    if (link.dataset.page + 'Page' === pageId) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            function setLoggedInState(loggedIn) {
                isLoggedIn = loggedIn;
                if (isLoggedIn) {
                    loginPage.classList.remove('active');
                    appContainer.classList.add('active');
                    showPage('homePage'); // Default to home after login
                    document.getElementById('loggedInUserName').textContent = 'Supervisor Demo'; // Replace with actual user name
                    document.getElementById('loggedInUserRole').textContent = 'Supervisor'; // Replace with actual user role
                } else {
                    loginPage.classList.add('active');
                    appContainer.classList.remove('active');
                }
            }

            // Simulate Login
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                document.getElementById('loginError').textContent = ''; // Clear error
                setLoggedInState(true); // For demo purposes, just log in
            });

            // Simulate Logout
            logoutBtn.addEventListener('click', () => {
                setLoggedInState(false);
            });

            // Navigation
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    showPage(e.target.dataset.page + 'Page');
                });
            });

            // --- Attendance Marking Module Logic (UI only) ---
            function applyAttendanceRowStatus(row) {
                const select = row.querySelector('.attendance-status-dropdown');
                const selectedStatus = select.value;
                const agentNameCell = row.querySelector('td:first-child');

                // Remove existing status classes
                row.classList.remove('status-present', 'status-late', 'status-absent', 'status-excused_absence', 'status-on_leave', 'status-holiday');
                agentNameCell.classList.remove('agent-greyed-out');


                // Add new status class and grey out agent name if absent/on leave/holiday
                if (selectedStatus === 'present') {
                    row.classList.add('status-present');
                } else if (selectedStatus === 'late') {
                    row.classList.add('status-late');
                } else if (selectedStatus === 'absent') {
                    row.classList.add('status-absent');
                    agentNameCell.classList.add('agent-greyed-out');
                } else if (selectedStatus === 'excused_absence') {
                    row.classList.add('status-excused_absence');
                    agentNameCell.classList.add('agent-greyed-out');
                } else if (selectedStatus === 'on_leave') {
                    row.classList.add('status-on_leave');
                    agentNameCell.classList.add('agent-greyed-out');
                } else if (selectedStatus === 'holiday') {
                    row.classList.add('status-holiday');
                    agentNameCell.classList.add('agent-greyed-out');
                }

                // Grey out time fields if status indicates not present
                const timeCells = row.querySelectorAll('.editable-time');
                if (['absent', 'excused_absence', 'on_leave', 'holiday'].includes(selectedStatus)) {
                    timeCells.forEach(cell => {
                        cell.style.backgroundColor = '#f0f0f0'; // Light grey background
                        cell.style.color = '#aaa'; // Lighter text color
                        cell.contentEditable = 'false'; // Make non-editable
                    });
                } else {
                    timeCells.forEach(cell => {
                        cell.style.backgroundColor = ''; // Reset background
                        cell.style.color = ''; // Reset text color
                        cell.contentEditable = 'true'; // Make editable
                    });
                }
            }

            // Event listener for changes in status dropdowns
            attendanceTableBody.addEventListener('change', (event) => {
                if (event.target.classList.contains('attendance-status-dropdown')) {
                    const row = event.target.closest('tr');
                    applyAttendanceRowStatus(row);
                }
            });

            // Apply initial status styles to existing rows
            document.querySelectorAll('.attendance-table tbody tr').forEach(row => {
                applyAttendanceRowStatus(row);
            });


            // --- Admin Panel Logic (UI only) ---
            addAgentForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const agentName = document.getElementById('agentName').value;
                const agentEmail = document.getElementById('agentEmail').value;

                if (agentName && agentEmail) {
                    const li = document.createElement('li');
                    li.innerHTML = `${agentName} (${agentEmail}) <button class="btn btn-sm btn-danger remove-agent-btn">Remove</button>`;
                    agentsList.appendChild(li);

                    document.getElementById('agentName').value = '';
                    document.getElementById('agentEmail').value = '';
                    alert(`Agent '${agentName}' added! (UI only)`);
                    // In real app: call Firebase Cloud Function to add user
                } else {
                    alert('Please enter both name and email.');
                }
            });

            agentsList.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-agent-btn')) {
                    if (confirm('Are you sure you want to remove this agent?')) {
                        const li = e.target.closest('li');
                        const agentText = li.textContent.replace(' Remove', '');
                        li.remove();
                        alert(`Agent '${agentText}' removed! (UI only)`);
                        // In real app: call Firebase Cloud Function to remove user
                    }
                }
            });

            // Simulate loading attendance data (replace with Firebase fetch)
            loadAttendanceBtn.addEventListener('click', () => {
                const selectedDate = attendanceDateFilter.value;
                const selectedTeam = teamFilter.value;
                alert(`Loading attendance for ${selectedDate} (Team: ${selectedTeam})... (UI Only)`);
                // In real app: Fetch data from Firestore based on date/team
                // And then populate attendanceTableBody dynamically
                // Example of populating:
                // attendanceTableBody.innerHTML = ''; // Clear existing
                // const newRow = document.createElement('tr');
                // newRow.innerHTML = `... your new row HTML ...`;
                // attendanceTableBody.appendChild(newRow);
                // applyAttendanceRowStatus(newRow); // Apply styles after adding
            });

            // Simulate saving attendance data
            saveAttendanceBtn.addEventListener('click', () => {
                const attendanceData = [];
                attendanceTableBody.querySelectorAll('tr').forEach(row => {
                    const agentId = row.dataset.agentId;
                    const agentName = row.dataset.agentName;
                    const status = row.querySelector('.attendance-status-dropdown').value;
                    const clockIn = row.children[2].textContent;
                    const clockOut = row.children[3].textContent;
                    const breakStart = row.children[4].textContent;
                    const breakEnd = row.children[5].textContent;
                    const notes = row.children[6].textContent;

                    attendanceData.push({
                        agentId, agentName, status, clockIn, clockOut, breakStart, breakEnd, notes
                    });
                });
                console.log('Saving attendance data (UI Only):', attendanceData);
                alert('Attendance data saved! (UI Only)');
                // In real app: Send this data to a Firebase Cloud Function for batch update
            });


            setLoggedInState(false); // Start on login page
        });
    </script>
</body>
</html>
